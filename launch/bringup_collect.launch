<?xml version="1.0"?>
<launch xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="https://gist.githubusercontent.com/nalt/dfa2abc9d2e3ae4feb82ca5608090387/raw/roslaunch.xsd">
  <arg name="robot_ip" default="127.0.0.1" />

  <arg name="rgbd_ip" default="" />
  <arg name="rgb_ip" default="" />
  <arg name="rgb_name" default="" />
  <arg name="rgb_user" default="" />
  <arg name="rgb_pw" default="" />

  <arg name="luxonis_parent_frame" default="tool0" />
  <arg name="luxonis_cam_pos_x" default="0.175319" />
  <arg name="luxonis_cam_pos_y" default="0.39145" />
  <arg name="luxonis_cam_pos_z" default="0.047145" />
  <arg name="luxonis_cam_roll" default="0.0" />
  <arg name="luxonis_cam_pitch" default="0.0" />
  <arg name="luxonis_cam_yaw" default="1.3089969387" />

  <!-- ROBOT -->
  <include file="$(find biodigitalmatter_ros)/launch/robot_descriptions.launch">
    <arg name="robot_model" value="$(arg robot_model)" />
  </include>

  <include file="$(find abb_robot_bringup_examples)/launch/ex1_rws_only.launch">
    <arg name="robot_ip" value="$(arg robot_ip)" />
  </include>

  <node pkg="robot_state_publisher" type="robot_state_publisher" name="rob_st_pub">
    <remap from="joint_states" to="/rws/joint_states" />
  </node>

  <!-- RBGD cameras -->
  <include file="$(find depthai_ros_driver)/launch/rgbd_pcl.launch">
    <arg name="parent_frame" value="$(arg luxonis_parent_frame)" />
    <arg name="cam_pos_x" value="$(arg luxonis_cam_pos_x)" />
    <arg name="cam_pos_y" value="$(arg luxonis_cam_pos_y)" />
    <arg name="cam_pos_z" value="$(arg luxonis_cam_pos_z)" />
    <arg name="cam_roll" value="$(arg luxonis_cam_roll)" />
    <arg name="cam_pitch" value="$(arg luxonis_cam_pitch)" />
    <arg name="cam_yaw" value="$(arg luxonis_cam_yaw)" />
    <arg name="camera_model" value="OAK-D-POE" />
    <arg name="params_file" value="$(find biodigitalmatter_ros)/config/oak-d-s2-af-poe/rgbd.yaml" />
  </include>

  <!-- RGB cameras -->
  <node pkg="tf" type="static_transform_publisher" name="$(arg rgb_name)_broadcaster"
    args="0 0 0 0 0 0 1 world $(arg rgb_name)_camera_link 100" />

  <group ns="$(arg rgb_name)">
    <param name="frame_id" value="world" />
  </group>

  <include file="$(find axis_camera)/launch/axis.launch">
    <arg name="camera_name" value="$(arg rgb_name)" />
    <arg name="hostname" value="$(arg rgb_ip)" />
    <arg name="username" value="$(arg rgb_user)" />
    <arg name="password" value="$(arg rgb_pw)" />
    <arg name="width" value="1280" />
    <arg name="height" value="720" />
    <arg name="fps" value="25" />
  </include>

  <!-- <node pkg="aruco_detect" name="aruco_detect" 
    type="aruco_detect" output="screen" respawn="false" /> -->

  <!-- RECORD -->
  <node name="record" pkg="rosbag" type="record"
    args="--all --output-prefix=$(env HOME)/rosbags/biodigitalmatter --split --size=50000 --lz4" />

</launch>
